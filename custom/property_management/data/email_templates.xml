<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- Email Template for Sales Offer -->
        <record id="email_template_sales_offer" model="mail.template">
            <field name="name">Property Sales Offer</field>
            <field name="model_id" ref="model_property_sale"/>
            <field name="subject">Sales Offer for {{ object.property_id.name }} - {{ object.name }}</field>
            <field name="email_from">{{ user.email or '' }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="email_cc">{{ user.email or '' }}</field>
            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 13px; color: rgb(34, 34, 34); background-color: rgb(255, 255, 255);">
                    <p>Dear {{ object.partner_id.name }},</p>
                    
                    <p>Thank you for your interest in our property. Please find attached your personalized sales offer for:</p>
                    
                    <div style="margin: 20px 0px; padding: 15px; background-color: #f8f9fa; border-left: 4px solid #007bff;">
                        <strong>Property Details:</strong><br/>
                        <strong>Property Name:</strong> {{ object.property_id.name }}<br/>
                        <strong>Project:</strong> {{ object.property_id.project_name or 'N/A' }}<br/>
                        <strong>Unit No:</strong> {{ object.property_id.unit_no or 'N/A' }}<br/>
                        <strong>Total Area:</strong> {{ object.property_id.total_sqft or 'N/A' }} sqft<br/>
                    </div>
                    
                    <div style="margin: 20px 0px; padding: 15px; background-color: #e8f5e8; border-left: 4px solid #28a745;">
                        <strong>Financial Summary:</strong><br/>
                        <strong>Property Value:</strong> {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(object.property_value) }}<br/>
                        <strong>Down Payment:</strong> {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(object.down_payment) }} ({{ object.down_payment_percentage }}%)<br/>
                        <strong>Total Selling Price:</strong> {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(object.total_selling_price) }}<br/>
                        <strong>Monthly Installment:</strong> {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(object.amount_per_installment) }}<br/>
                    </div>
                    
                    <p><strong>Key Benefits:</strong></p>
                    <ul>
                        <li>Flexible payment plan with {{ object.no_of_installments }} installments</li>
                        <li>Competitive pricing in prime location</li>
                        <li>Professional property management</li>
                        <li>Transparent payment schedule</li>
                    </ul>
                    
                    <p>The detailed sales offer document is attached to this email. Please review it carefully and don't hesitate to contact us if you have any questions.</p>
                    
                    <p><strong>Next Steps:</strong></p>
                    <ol>
                        <li>Review the attached sales offer document</li>
                        <li>Contact us to schedule a property viewing (if not done already)</li>
                        <li>Discuss any questions or modifications</li>
                        <li>Proceed with the booking process</li>
                    </ol>
                    
                    <p>This offer is valid for 30 days from the date of issue. We're excited to help you with your property investment journey!</p>
                    
                    <p>Best regards,<br/>
                    {{ user.name }}<br/>
                    {{ user.phone or '' }}<br/>
                    {{ user.email or '' }}<br/>
                    <em>Real Estate Sales Team</em></p>
                    
                    <div style="margin-top: 30px; padding: 10px; background-color: #fff3cd; border: 1px solid #ffeaa7; border-radius: 5px;">
                        <small><strong>Important:</strong> This sales offer is confidential and intended solely for the recipient. Please do not share this information with third parties without our consent.</small>
                    </div>
                </div>
            </field>
            <field name="auto_delete">True</field>
        </record>

        <!-- Email Template for Contract Agreement -->
        <record id="email_template_contract" model="mail.template">
            <field name="name">Property Sale Contract</field>
            <field name="model_id" ref="model_property_sale"/>
            <field name="subject">Property Sale Contract - {{ object.property_id.name }} - {{ object.name }}</field>
            <field name="email_from">{{ user.email or '' }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="email_cc">{{ user.email or '' }}</field>
            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 13px; color: rgb(34, 34, 34); background-color: rgb(255, 255, 255);">
                    <p>Dear {{ object.partner_id.name }},</p>
                    
                    <p>We are pleased to provide you with the <strong>Property Sale Contract Agreement</strong> for your property purchase.</p>
                    
                    <div style="margin: 20px 0px; padding: 15px; background-color: #f0fdf4; border-left: 4px solid #10b981;">
                        <strong>Contract Details:</strong><br/>
                        <strong>Contract No:</strong> {{ object.name }}<br/>
                        <strong>Property:</strong> {{ object.property_id.name }}<br/>
                        <strong>Unit:</strong> {{ object.property_id.unit_no or 'N/A' }}<br/>
                        <strong>Contract Value:</strong> {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(object.total_selling_price) }}<br/>
                        <strong>Contract Date:</strong> {{ object.sale_date.strftime('%d %B %Y') }}<br/>
                    </div>
                    
                    <p><strong>Important Information:</strong></p>
                    <ul>
                        <li>This is a <strong>legally binding contract</strong></li>
                        <li>Please review all terms and conditions carefully</li>
                        <li>Both parties must sign for the contract to be valid</li>
                        <li>Retain the signed original for your records</li>
                    </ul>
                    
                    <p><strong>Next Steps:</strong></p>
                    <ol>
                        <li>Review the attached contract thoroughly</li>
                        <li>Seek independent legal advice if needed</li>
                        <li>Sign and return two copies to our office</li>
                        <li>Keep one signed copy for your records</li>
                        <li>Make the first payment as per payment schedule</li>
                    </ol>
                    
                    <p>The contract agreement is attached to this email. If you have any questions or concerns, please don't hesitate to contact us.</p>
                    
                    <div style="margin: 20px 0px; padding: 15px; background-color: #fee2e2; border-left: 4px solid #ef4444;">
                        <strong style="color: #991b1b;">Legal Notice:</strong><br/>
                        <span style="color: #7f1d1d;">
                            We strongly recommend that you seek independent legal advice before signing this contract. 
                            Once signed, this agreement is legally binding and enforceable by law.
                        </span>
                    </div>
                    
                    <p>Thank you for choosing us for your property investment.</p>
                    
                    <p>Best regards,<br/>
                    {{ user.name }}<br/>
                    {{ user.phone or '' }}<br/>
                    {{ user.email or '' }}<br/>
                    <em>Property Sales Department</em></p>
                    
                    <div style="margin-top: 30px; padding: 10px; background-color: #fef3c7; border: 1px solid #fbbf24; border-radius: 5px;">
                        <small><strong>Confidential:</strong> This contract is confidential and intended solely for the parties named herein. Please do not share this document with unauthorized third parties.</small>
                    </div>
                </div>
            </field>
            <field name="auto_delete">True</field>
        </record>

        <!-- Email Template for Statement of Account -->
        <record id="email_template_statement" model="mail.template">
            <field name="name">Statement of Account</field>
            <field name="model_id" ref="model_property_sale"/>
            <field name="subject">Statement of Account - {{ object.name }} - {{ object.partner_id.name }}</field>
            <field name="email_from">{{ user.email or '' }}</field>
            <field name="email_to">{{ object.partner_id.email }}</field>
            <field name="email_cc">{{ user.email or '' }}</field>
            <field name="body_html" type="html">
                <div style="margin: 0px; padding: 0px; font-family: 'Lucida Grande', Ubuntu, Arial, Verdana, sans-serif; font-size: 13px; color: rgb(34, 34, 34); background-color: rgb(255, 255, 255);">
                    <p>Dear {{ object.partner_id.name }},</p>
                    
                    <p>Please find attached your <strong>Statement of Account</strong> for the property purchase.</p>
                    
                    <div style="margin: 20px 0px; padding: 15px; background-color: #f0fdf4; border-left: 4px solid #10b981;">
                        <strong>Account Summary:</strong><br/>
                        <strong>Account No:</strong> {{ object.name }}<br/>
                        <strong>Property:</strong> {{ object.property_id.name }}<br/>
                        <strong>Total Contract Value:</strong> {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(object.total_selling_price) }}<br/>
                        <strong>Payment Progress:</strong> {{ '{:.1f}'.format(object.payment_progress) }}%<br/>
                        <strong>Statement Date:</strong> {{ datetime.datetime.now().strftime('%d %B %Y') }}<br/>
                    </div>
                    
                    {% set paid_amount = sum(object.property_sale_line_ids.filtered(lambda l: l.collection_status == 'paid').mapped('capital_repayment')) %}
                    {% set outstanding = sum(object.property_sale_line_ids.filtered(lambda l: l.collection_status == 'unpaid').mapped('capital_repayment')) %}
                    {% set next_payment = object.property_sale_line_ids.filtered(lambda l: l.collection_status == 'unpaid').sorted(key=lambda x: x.collection_date)[:1] %}
                    
                    <div style="margin: 20px 0px; display: table; width: 100%;">
                        <div style="display: table-cell; width: 50%; padding: 15px; background-color: #d1fae5; border-radius: 8px; margin-right: 10px;">
                            <strong style="color: #065f46;">Amount Paid:</strong><br/>
                            <span style="font-size: 20px; font-weight: 700; color: #047857;">
                                {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(paid_amount) }}
                            </span>
                        </div>
                        <div style="display: table-cell; width: 50%; padding: 15px; background-color: #fed7aa; border-radius: 8px;">
                            <strong style="color: #92400e;">Balance Outstanding:</strong><br/>
                            <span style="font-size: 20px; font-weight: 700; color: #b45309;">
                                {{ object.currency_id.symbol }}{{ '{:,.2f}'.format(outstanding) }}
                            </span>
                        </div>
                    </div>
                    
                    {% if next_payment %}
                    <div style="margin: 20px 0px; padding: 15px; background-color: #fffbeb; border-left: 4px solid #f59e0b;">
                        <strong style="color: #92400e;">Next Payment Due:</strong><br/>
                        Amount: <strong>{{ object.currency_id.symbol }}{{ '{:,.2f}'.format(next_payment.capital_repayment) }}</strong><br/>
                        Due Date: <strong>{{ next_payment.collection_date.strftime('%d %B %Y') }}</strong>
                    </div>
                    {% endif %}
                    
                    <p><strong>Payment Information:</strong></p>
                    <ul>
                        <li>Please ensure timely payments to avoid late payment charges</li>
                        <li>Grace period: 15 days from due date</li>
                        <li>Late payment charges: 1.5% per month on overdue amounts</li>
                        <li>Early payment is welcome without penalty</li>
                    </ul>
                    
                    <p>The detailed statement of account is attached to this email. If you have any questions regarding your account or need to make a payment, please contact our accounts department.</p>
                    
                    <p><strong>Payment Methods:</strong></p>
                    <ul>
                        <li>Bank Transfer (details provided in statement)</li>
                        <li>Cheque (payable to our company name)</li>
                        <li>Credit/Debit Card (contact our office)</li>
                    </ul>
                    
                    <p>Thank you for your continued trust in our services.</p>
                    
                    <p>Best regards,<br/>
                    {{ user.name }}<br/>
                    Accounts Department<br/>
                    {{ user.phone or '' }}<br/>
                    {{ user.email or '' }}</p>
                    
                    <div style="margin-top: 30px; padding: 10px; background-color: #dbeafe; border: 1px solid #3b82f6; border-radius: 5px;">
                        <small><strong>Note:</strong> This statement is generated automatically and is accurate as of the date shown. For real-time account information, please contact our office.</small>
                    </div>
                </div>
            </field>
            <field name="auto_delete">True</field>
        </record>
    </data>
</odoo>